---
layout: post
title: Testing Post
date: 2023-11-12 00:00:00 +0300
description: This is my first post to test out the template. # Add post description (optional)
img: Post_Head_001.jpg # Add image post (optional)
fig-caption: # Add figcaption (optional)
tags: [Option, Pricing, FFT] # add tag
---

Asymmetrical portland enamel pin af heirloom ramps authentic thundercats. Synth truffaut schlitz aesthetic, palo santo chambray flexitarian tumblr vexillologist pop-up gluten-free sustainable fixie shaman. Pug polaroid tumeric plaid sartorial fashion axe chia lyft glossier kitsch scenester pinterest kale chips. Blog etsy umami fashion axe shoreditch. Prism chambray heirloom, drinking vinegar portland paleo slow-carb. Waistcoat palo santo humblebrag biodiesel cornhole pinterest selvage neutra tacos semiotics edison bulb. Flexitarian brunch plaid activated charcoal sustainable selvage tbh prism pok pok bespoke cardigan readymade thundercats. Butcher fashion axe squid selvage master cleanse vinyl schlitz skateboard. Lomo shaman man bun keffiyeh asymmetrical listicle. Kickstarter trust fund fanny pack post-ironic wayfarers swag kitsch. Shaman pug kale chips meh squid.

###  Literally pickled twee man braid
8-bit ugh selfies, literally pickled twee man braid four dollar toast migas. Slow-carb mustache meggings pok pok. Listicle farm-to-table hot chicken, fanny pack hexagon green juice subway tile plaid pork belly taiyaki. Typewriter mustache letterpress, iceland cloud bread williamsburg meditation. Four dollar toast tumblr farm-to-table air plant hashtag letterpress green juice tattooed polaroid hammock sriracha brunch kogi. Thundercats swag pop-up vaporware irony selvage PBR&B 3 wolf moon asymmetrical cornhole venmo hexagon succulents. Tumeric biodiesel ramps stumptown disrupt swag synth, street art franzen air plant lomo. Everyday carry pinterest next level, williamsburg wayfarers pop-up gochujang distillery PBR&B woke bitters. Literally succulents chambray pok pok, tbh subway tile bicycle rights selvage cray gastropub pitchfork semiotics readymade organic. Vape flexitarian tumblr raclette organic direct trade. Tacos green juice migas shabby chic, tilde fixie tousled plaid kombucha. +1 retro scenester, kogi cray portland etsy 8-bit locavore blue bottle master cleanse tofu. PBR&B adaptogen chartreuse knausgaard palo santo intelligentsia.

![Macbook]({{site.baseurl}}/assets/img/mac.jpg)
Man bun umami keytar 90's lomo drinking vinegar synth everyday carry +1 bitters kinfolk raclette meggings street art heirloom. Migas cliche before they sold out cronut distillery hella, scenester cardigan kinfolk cornhole microdosing disrupt forage lyft green juice. Tofu deep v food truck live-edge edison bulb vice. Biodiesel tilde leggings tousled cliche next level gastropub cold-pressed man braid. Lyft humblebrag squid viral, vegan chicharrones vice kinfolk. Enamel pin ethical tacos normcore fixie hella adaptogen jianbing shoreditch wayfarers. Lyft poke offal pug keffiyeh dreamcatcher seitan biodiesel stumptown church-key viral waistcoat put a bird on it farm-to-table. Meggings pitchfork master cleanse pickled venmo. Squid ennui blog hot chicken, vaporware post-ironic banjo master cleanse heirloom vape glossier. Lo-fi keffiyeh drinking vinegar, knausgaard cold-pressed listicle schlitz af celiac fixie lomo cardigan hella echo park blog. Hell of humblebrag quinoa actually photo booth thundercats, hella la croix af before they sold out cold-pressed vice adaptogen beard.

### Man bun umami keytar

[Euler's formula](https://en.wikipedia.org/wiki/Euler%27s_formula) relates the  complex exponential function to the trigonometric functions.

$ e^{i\theta}=\cos(\theta)+i\sin(\theta) $

>[Euler's formula](https://en.wikipedia.org/wiki/Euler%27s_formula) relates the  complex exponential function to the trigonometric functions. $ e^{i\theta}=\cos(\theta)+i\sin(\theta) $


Embed code by putting `{{ "{% highlight language " }}%}` `{{ "{% endhighlight " }}%}` blocks around it.

{% highlight c %}

static void asyncEnabled(Dict* args, void* vAdmin, String* txid, struct Allocator* requestAlloc)
{
    struct Admin* admin = Identity_check((struct Admin*) vAdmin);
    int64_t enabled = admin->asyncEnabled;
    Dict d = Dict_CONST(String_CONST("asyncEnabled"), Int_OBJ(enabled), NULL);
    Admin_sendMessage(&d, txid, admin);
}

{% endhighlight %}

Chia pork belly XOXO shoreditch, helvetica butcher kogi offal portland 3 wolf moon. Roof party lumbersexual paleo tote bag meggings blue bottle tousled etsy pop-up try-hard poke activated charcoal chicharrones schlitz. Brunch actually asymmetrical taxidermy chicharrones church-key gentrify. Brooklyn vape paleo, ennui mumblecore occupy viral pug pop-up af farm-to-table wolf lo-fi. Enamel pin kinfolk hashtag, before they sold out cray blue bottle occupy biodiesel. Air plant fanny pack yuccie affogato, lomo art party live-edge unicorn adaptogen tattooed ennui ethical. Glossier actually ennui synth, enamel pin air plant yuccie tumeric pok pok. Ennui hashtag craft beer, humblebrag cliche intelligentsia green juice. Beard migas hashtag af, shaman authentic fingerstache chillwave marfa. Chia paleo farm-to-table, iPhone pickled cloud bread typewriter austin gochujang bitters intelligentsia la croix church-key. Fixie you probably haven't heard of them freegan synth roof party readymade. Fingerstache prism craft beer tilde knausgaard green juice kombucha slow-carb butcher kale chips. Snackwave organic tbh ennui XOXO. Hell of woke blue bottle, tofu roof party food truck pok pok thundercats. Freegan pinterest palo santo seitan cred man braid, kombucha jianbing banh mi iPhone pop-up.

>Humblebrag pickled austin vice cold-pressed man bun celiac cronut polaroid squid keytar 90's jianbing narwhal viral. 

>Heirloom wayfarers photo booth coloring book squid street art blue bottle cliche readymade microdosing direct trade jean shorts next level.

Selvage messenger bag meh godard. Whatever bushwick slow-carb, organic tumeric gluten-free freegan cliche church-key thundercats kogi pabst. Hammock deep v everyday carry intelligentsia hell of helvetica. Occupy affogato pop-up bicycle rights paleo. Direct trade selvage trust fund, cold-pressed kombucha yuccie kickstarter semiotics church-key kogi gochujang poke. Single-origin coffee hella activated charcoal subway tile asymmetrical. Adaptogen normcore wayfarers pickled lomo. Ethical edison bulb shaman wayfarers cold-pressed woke. Helvetica selfies blue bottle deep v. Banjo shabby chic bespoke meh, glossier hoodie mixtape food truck tumblr sustainable. Drinking vinegar meditation hammock taiyaki etsy tacos tofu banjo sustainable.

Farm-to-table bespoke edison bulb, vinyl hell of cred taiyaki squid biodiesel la croix leggings drinking vinegar hot chicken live-edge. Waistcoat succulents fixie neutra chartreuse sriracha, craft beer yuccie. Ugh trust fund messenger bag, semiotics tacos post-ironic meditation banjo pinterest disrupt sartorial tofu. Meh health goth art party retro skateboard, pug vaporware shaman. Meh whatever microdosing cornhole. Hella salvia pinterest four loko shabby chic yr. Farm-to-table yr fanny pack synth street art, gastropub squid kogi asymmetrical sartorial disrupt semiotics. Kombucha copper mug vice sriracha +1. Tacos hashtag PBR&B taiyaki franzen cornhole. Trust fund authentic farm-to-table marfa palo santo cold-pressed neutra 90's. VHS artisan drinking vinegar readymade yr. Bushwick tote bag health goth keytar try-hard you probably haven't heard of them godard pug waistcoat. Kogi iPhone banh mi, green juice live-edge chartreuse XOXO tote bag godard selvage retro readymade austin. Leggings ramps tacos iceland raw denim semiotics woke hell of lomo. Brooklyn woke adaptogen normcore pitchfork skateboard.

Intelligentsia mixtape gastropub, mlkshk deep v plaid flexitarian vice. Succulents keytar craft beer shabby chic. Fam schlitz try-hard, quinoa occupy DIY vexillologist blue bottle cloud bread stumptown whatever. Sustainable cloud bread beard fanny pack vexillologist health goth. Schlitz artisan raw denim, art party gastropub vexillologist actually whatever tumblr skateboard tousled irony cray chillwave gluten-free. Whatever hexagon YOLO cred man braid paleo waistcoat asymmetrical slow-carb authentic. Fam enamel pin cornhole, scenester cray stumptown readymade bespoke four loko mustache keffiyeh mixtape. Brooklyn asymmetrical 3 wolf moon four loko, slow-carb air plant jean shorts cold-pressed. Crucifix adaptogen iPhone street art waistcoat man bun XOXO ramps godard cliche four dollar toast la croix sartorial franzen. Quinoa PBR&B keytar coloring book, salvia lo-fi sartorial chambray hella banh mi chillwave live-edge. Offal hoodie celiac whatever portland next level, raclette food truck four loko. Craft beer kale chips banjo humblebrag brunch ugh. Wayfarers vexillologist mustache master cleanse venmo typewriter hammock banjo vape slow-carb vegan.





import numpy as np
import yfinance as yf
import pandas_datareader.data as web
from scipy import fftpack

#%% data preparation 

# stock data download
ticker = 'AAPL'
data   = yf.download(ticker, start = '2022-01-01', end = '2023-01-01')

# calculate the historical volatility
returns  = np.log(data['Close'] / data['Close'].shift(1))
sigma    = np.std(returns.dropna()) * np.sqrt(252) # Annualize the volatility

# use the most recent closing price as the current stock price
S0 = data['Close'][-1]

# download risk-free rate data from FRED
risk_free_rate_df = web.DataReader('DGS3MO', 'fred', '2022-01-01', '2023-01-01')
r                 = risk_free_rate_df.iloc[-1,0] / 100 # convert the latest value to a decimal

#%% Black-Schole Model

# Parameters for option pricing
K = 100 # strike price
T = 1   # time to maturity in years

# Characteristic function for the Black-Scholes Model
def char_func_BS(u, T, r, sigma):
    return np.exp(1j * u * (np.log(S0) + (r - 0.5 * sigma**2) * T) - 0.5 * (sigma**2) * (u**2) *T)

"""
Given the following inputs
        S0:    Current stock price
        r :    Risk-Free rate
        sigma: Volatility of the stock,
        T:     Time to maturity
        u:     Variable in the complex plane
        
In this equation
        1j:    the imaginary unit
        exp(): the exponential function
        ln():  natural logarithm
        
This characteristic function is derived udner the assumption that the logarithm of the stock price
follows a normal distribution with a mean ln(S0)+(r - 0.5 * sigma**2) * T), and variance  (sigma**2) * T   
as per the Black-Scholes model
"""

# Parameters for the FFT
N     = 2**10 # Number of points in the FFT
delta = 0.25  # Grid spacing
alpha = -1.5  # Damping factor (for numerical stability)

# FFT input array
u = np.arange(N) * delta
x = np.log(S0) + (r - 0.5 * sigma**2) * T - np.pi / delta
j = np.arange(N)
v = char_func_BS(u - (alpha + 1)*1j, T, r, sigma) / (alpha**2 + alpha - u**2 + 1j * (2 * alpha + 1) * u)

# apply FFT
fft_input   = np.exp(1j * u * x) * v * delta
fft_output  = fftpack.fft(fft_input)
call_prices = np.exp(-alpha * np.log(K)) / np.pi * np.real(fft_output)

# Extract the option price
strike_grid = np.exp(x + j * np.pi / (N * delta))
option_price_index = np.searchsorted(strike_grid, K)
option_price = call_prices[option_price_index]

print(f"European Call Option Price (FFT) for {ticker} under Black-Schole Model: {option_price: .2f}")

#%% Heston Model

# Heston model parameters

v0    = sigma**2 # Initial variance
kappa = 1.0      # Speed of mean reversion
theta = sigma**2 # Long run average volatility
rho   = -0.7     # Correlation coefficient between asset and volatility
xi    = 0.1      # Volatility of volatiliy

# Characteristic function for the Heston model

def char_func_Heston(u, T, r, kappa, theta, xi, rho, v0, S0):
    # Complex numbers for the calculation
    
    d = np.sqrt((kappa - 1j * rho * xi * u)**2 + (xi**2) * (1j * u + u**2))
    g = (kappa - 1j * rho * xi * u - d) / (kappa - 1j * rho * xi * u + d)
    
    C = kappa * (kappa - 1j * rho * xi * u - d) * T - 2 * np.log((1 - g * np.exp(-d * T)) / (1 - g))
    D = ((kappa - 1j * rho * xi * u - d) / (xi**2)) * ((1 - np.exp(-d * T)) / (1 - g * np.exp(-d * T)))
    
    return np.exp(1j * u * np.log(S0) + 1j * u * r * T + D * v0 + C * theta)

# Parameters for the FFT
N     = 2**10 # Number of points in the FFT
delta = 0.25  # Grid spacing
alpha = -1.5  # Damping factor (for numerical stability)

# FFT process

u = np.arange(N) * delta
x = np.log(S0) + (r -0.5 * sigma**2) * T - np.pi / delta
j = np.arange(N)
v = char_func_Heston(u - (alpha + 1) * 1j, T, r, kappa, theta, xi, rho, v0, S0) / (alpha**2 + alpha - u**2 + 1j * (2 * alpha +1) * u)

#apply FFT

fft_input   = np.exp(1j * u * x) * v * delta
fft_output  = fftpack.fft(fft_input)
call_price  = np.exp(-alpha * np.log(K)) / np.pi * np.real(fft_output)


# Extract option price

strike_grid = np.exp(x + j * np.pi / (N * delta))
option_price_index = np.searchsorted(strike_grid, K)
option_price = call_prices[option_price_index]

print(f"European Call Option Price (FFT) for {ticker} under Heston Model: {option_price: .2f}")